(this["webpackJsonpstonks-app"]=this["webpackJsonpstonks-app"]||[]).push([[0],{11:function(t,e,n){},23:function(t,e,n){},30:function(t,e,n){"use strict";n.r(e);var r,a=n(1),s=n.n(a),i=n(15),c=n.n(i),o=(n(23),n(8)),u=n.n(o),d=n(12),l=n(4),h=n(5),f=n(7),j=n(6),m=(n(11),n(16)),b=n.n(m);function p(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)}function g(t){return new Promise((function(e,n){b.a.parse(t,{complete:function(t){var n=t.data,a=n.findIndex((function(t){return"Account Trade History"===t[0]}))+2,s=n.findIndex((function(t,e){return e>a&&1===t.length})),i=n.slice(a,s);e(i.map((function(t){return{date:new Date(t[r.date]),side:t[r.side],qty:Math.abs(parseInt(t[r.qty],10)),symbol:t[r.symbol],price:p(parseFloat(t[r.price]),4),orderType:t[r.orderType]}})))}})}))}!function(t){t[t.date=1]="date",t[t.side=3]="side",t[t.qty=4]="qty",t[t.symbol=6]="symbol",t[t.price=10]="price",t[t.orderType=12]="orderType"}(r||(r={}));var O=n(18),y=n(9),x=n(3),v=n.n(x),T=n(2);function C(t){var e=y.groupBy(t,(function(t){return t.symbol})),n=[];return Object.keys(e).forEach((function(t){var r=e[t].sort((function(t,e){return t.date.getTime()-e.date.getTime()})),a=[];r.forEach((function(t){a.push(t),0===a.reduce((function(t,e){return t+("SELL"===e.side?-1:1)*e.qty}),0)&&(n.push(a),a=[])}))})),n}function Y(t,e,n,r){var a;return a="Symbol"===t?n[0].symbol.localeCompare(r[0].symbol):"Open"===t?n[0].date.getTime()-r[0].date.getTime():"Close"===t?n[n.length-1].date.getTime()-r[r.length-1].date.getTime():"Duration"===t?w(n)-w(r):"Profit ($)"===t?N(n)-N(r):"Profit (%)"===t?F(n)-F(r):0,e?a:-1*a}var k=function(t){Object(f.a)(n,t);var e=Object(j.a)(n);function n(t){var r;return Object(l.a)(this,n),(r=e.call(this,t)).state={sortBy:"Open",ascending:!1},r}return Object(h.a)(n,[{key:"onSort",value:function(t){this.setState({sortBy:t,ascending:this.state.sortBy===t&&!this.state.ascending})}},{key:"renderTrades",value:function(){var t=this,e=C(this.props.trades).sort(Y.bind(this,this.state.sortBy,this.state.ascending));return Object(T.jsxs)("table",{className:"matched-trades",children:[Object(T.jsx)("tr",{children:["Symbol","Open","Close","Duration","Shares","Buy Price","Sell Price","Profit ($)","Profit (%)"].map((function(e){return Object(T.jsxs)("th",{className:"sortable",onClick:function(){return t.onSort(e)},children:[e,Object(T.jsx)("span",{className:t.state.sortBy===e?t.state.ascending?"up":"down":"none",children:"\u2191"})]},e)}))}),e.map((function(t,e){var n=t[0],r=t[t.length-1],a=t.filter((function(t){return"BUY"===t.side})),s=t.filter((function(t){return"SELL"===t.side})),i=P(a),c=P(s),o=a.reduce((function(t,e){return t+e.qty}),0);return Object(T.jsxs)("tr",{children:[Object(T.jsx)("td",{children:n.symbol}),Object(T.jsx)("td",{className:"small-font",children:q(n.date)}),Object(T.jsx)("td",{className:"small-font",children:q(r.date)}),Object(T.jsx)("td",{children:S(t)}),Object(T.jsx)("td",{children:o}),Object(T.jsx)("td",{children:W(i)}),Object(T.jsx)("td",{children:W(c)}),Object(T.jsx)("td",{children:W(N(t))}),Object(T.jsx)("td",{children:U(F(t))})]},e)}))]})}},{key:"render",value:function(){return Object(T.jsxs)("div",{children:[Object(T.jsx)("h3",{children:"Positions"}),this.renderTrades()]})}}]),n}(s.a.Component);function S(t){var e=t.sort((function(t,e){return t.date.getTime()-e.date.getTime()})),n=e[0],r=e[e.length-1],a=v()(r.date).diff(v()(n.date))/1e3,s=a>=60?"".concat(Math.floor(a/60),"m"):"",i=a%60?"".concat(Math.floor(a%60),"s"):"";return"".concat(s," ").concat(i)}function w(t){var e=t.sort((function(t,e){return t.date.getTime()-e.date.getTime()})),n=e[0],r=e[e.length-1];return v()(r.date).diff(v()(n.date))/1e3}function D(t){return C(t).reduce((function(t,e){var n=N(e);return n>0?(t.numWon++,t.amountWon+=n):n<0&&(t.numLost++,t.amountLost+=Math.abs(n)),t}),{numWon:0,numLost:0,amountWon:0,amountLost:0})}function M(t){var e=D(t),n=e.numWon;return n/(n+e.numLost)}function L(t){if(!t||0===t.length)return null;var e=t.reduce((function(t,e){return t+e}),0);return e?e/t.length:null}function P(t){return L(t.map((function(t){return t.price*t.qty})))/L(t.map((function(t){return t.qty})))}function B(t){var e=D(t);return e.amountWon/e.numWon/(e.amountLost/e.numLost)}function N(t){return t.reduce((function(t,e){return("BUY"===e.side?-1:1)*e.qty*e.price+t}),0)}function F(t){var e=P(t.filter((function(t){return"BUY"===t.side})));return N(t)/e}function q(t){return v()(t).format("M/D/YY h:mm:ss")}function W(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=Math.abs(t).toString().split("."),r=Object(O.a)(n,1),a=r[0],s="0"!==a?a.length:1,i=s+e;return new Intl.NumberFormat("en-US",{maximumSignificantDigits:i,style:"currency",currency:"USD"}).format(t)}function U(t){return"".concat(Object(y.round)(100*t,2),"%")}var I=function(t){Object(f.a)(n,t);var e=Object(j.a)(n);function n(){return Object(l.a)(this,n),e.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var t=this.props.trades,e=P(this.props.trades.filter((function(t){return"BUY"===t.side})));return Object(T.jsxs)("div",{children:[Object(T.jsx)("h3",{children:"Performance"}),Object(T.jsxs)("table",{className:"performance",children:[Object(T.jsxs)("tr",{children:[Object(T.jsx)("th",{children:"Profit ($)"}),Object(T.jsx)("td",{children:W(N(t),2)}),Object(T.jsx)("th",{children:"Accuracy (%)"}),Object(T.jsx)("td",{children:U(M(t))}),Object(T.jsx)("th",{children:"Wins "}),Object(T.jsx)("td",{children:D(t).numWon}),Object(T.jsx)("th",{children:"Average Position Size ($) "}),Object(T.jsx)("td",{children:W(e)})]}),Object(T.jsxs)("tr",{children:[Object(T.jsx)("th",{children:"Profit (%)"}),Object(T.jsx)("td",{children:U(F(t))}),Object(T.jsx)("th",{children:"P/L Ratio "}),Object(T.jsx)("td",{children:p(B(t),2)}),Object(T.jsx)("th",{children:"Losses "}),Object(T.jsx)("td",{children:D(t).numLost})]})]})]})}}]),n}(s.a.Component),E=n(17),R=(n(27),function(t){Object(f.a)(n,t);var e=Object(j.a)(n);function n(t){var r;return Object(l.a)(this,n),(r=e.call(this,t)).state={trades:[],dates:null,showCalendar:!1},r}return Object(h.a)(n,[{key:"onFileChange",value:function(){var t=Object(d.a)(u.a.mark((function t(e){var n,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.target.files&&0!==e.target.files.length){t.next=2;break}return t.abrupt("return");case 2:return n=e.target.files[0],t.next=5,g(n);case 5:r=t.sent,this.setState({trades:r});case 7:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"onDatesChanged",value:function(){var t=Object(d.a)(u.a.mark((function t(e){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.setState({dates:e,showCalendar:!1});case 1:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"renderDates",value:function(){var t=this,e="Filter by dates";if(this.state.dates){var n=v()(this.state.dates[0]).format("MMM Do, YYYY"),r=v()(this.state.dates[1]).format("MMM Do, YYYY");e=n===r?n:"".concat(n," - ").concat(r)}return[Object(T.jsxs)("button",{className:"dates",onClick:function(e){t.setState({showCalendar:!t.state.showCalendar})},children:[e,Object(T.jsx)("span",{className:"link",style:{fontSize:"0.6em",margin:"1em",padding:"0.25em",borderRadius:"0.4em",background:"white"},onClick:function(e){e.stopPropagation(),t.onDatesChanged(null)},children:"Reset"})]}),this.state.showCalendar?Object(T.jsx)("div",{style:{position:"fixed"},children:Object(T.jsx)(E.a,{selectRange:!0,maxDate:new Date,onChange:function(e){return t.onDatesChanged(e)},value:this.state.dates,tileClassName:function(e){var n,r=e.date,a=e.view,s=(t.dateKey(r,a),r.getTime());"decade"===a?(n=v()(r).year(v()(r).year()+1).toDate().getTime(),console.log("decade!",s,n)):"year"===a?n=v()(r).month(v()(r).month()+1).toDate().getTime():"month"===a&&(n=v()(r).add(1,"day").toDate().getTime());var i=N(t.state.trades.filter((function(t){return t.date.getTime()>s&&t.date.getTime()<n})));return console.log(i),i>0?"green":i<0?"red":null}})}):null]}},{key:"dateKey",value:function(t,e){return"decade"===e?v()(t).format("YYYY"):"year"===e?v()(t).format("M YYYY"):"month"===e?v()(t).format("M/D/YYYY"):null}},{key:"renderMessage",value:function(){if(!this.state.trades.length)return Object(T.jsxs)("h3",{children:[Object(T.jsx)("label",{htmlFor:"file",className:"link",children:"Upload a CSV"})," ","to get started"]})}},{key:"render",value:function(){var t=this,e=this.state.trades.filter((function(e){return null===t.state.dates||e.date.getTime()>t.state.dates[0].getTime()&&e.date.getTime()<t.state.dates[1].getTime()}));return Object(T.jsxs)("div",{children:[Object(T.jsx)("label",{htmlFor:"file",className:"file",children:"Upload CSV"}),Object(T.jsx)("input",{type:"file",id:"file",onChange:function(e){return t.onFileChange(e)}}),this.renderDates(),this.state.trades.length?[Object(T.jsx)(I,{trades:e}),Object(T.jsx)(k,{trades:e})]:this.renderMessage()]})}}]),n}(s.a.Component)),$=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,31)).then((function(e){var n=e.getCLS,r=e.getFID,a=e.getFCP,s=e.getLCP,i=e.getTTFB;n(t),r(t),a(t),s(t),i(t)}))};c.a.render(Object(T.jsx)(s.a.StrictMode,{children:Object(T.jsx)(R,{})}),document.getElementById("root")),$()}},[[30,1,2]]]);
//# sourceMappingURL=main.3b858e79.chunk.js.map